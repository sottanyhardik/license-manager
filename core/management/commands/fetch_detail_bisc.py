from django.core.management.base import BaseCommand, CommandError
from django.db.models import Q


from license.models import LicenseDetailsModel


class Command(BaseCommand):
    help = 'Closes the specified poll for voting'

    def handle(self, *args, **options):
        from item_fetch_bisc import fetch_data, split_list, generate_excel
        list1 = ['0310680954', '0310681422', '5610000026', '5610000025', '0310683014', '0310689065', '5610000757', '5610000774', '0310701844', '0310702495', '0310709650', '0510336995', '0310713518', '0310714016', '0310721821', '0310729479', '0310729712', '0310729706', '0310732679', '0310732837', '0310736179', '0310736178', '0310736634', '0310736635', '0310736637', '0310736630', '0310736633', '0310736838', '0310736957', '0310737816', '0310737818', '0310737859', '0310737945', '0310738215', '0310738501', '0310738503', '0310739944', '0310740498', '0310740492', '0310740546', '0310740542', '0310740591', '0310740606', '0310740883', '0310740886', '0310741378', '0310741591', '0310818080', '0310818438', '5610005397', '0310821169', '0310825085', '0310827509', '0310828159', '0310828188', '0310681621', '0310828173', '0310829658', '0310721806', '0310829956', '0310829966', '0310763644', '0310829982', '0310830074', '0310830107', '0310830441', '0310826693', '0310830480', '0310827015', '0310827361', '0310827442', '0310827783', '0310831828', '0310831992', '0310831990', '0310832269', '0310832880', '0310832985', '0310832983', '0310833197', '0310833198', '0310833199', '0310833589', '0310833591', '0310833729', '0310833822', '0310834150', '0310834152', '0310834612', '0310834800', '0310834824', '0310834927', '0310831147', '0310831148', '0310831149', '0310831843', '0310835121', '0310835189', '0310835188', '0310832494', '0310835517', '0310833846', '0310835559', '0310836589', '0310835514', '0310837994', '0310834974', '0310834976', '0310834966', '0310837998', '0310835296', '0310835340', '0310837232', '0310838970', '0310838915', '0310836033', '0310837233', '0311004966', '0311004351', '0310838101', '0310838098', '0311005427', '0311006070', '0310837902', '0311004330', '0311006833', '0311008749', '0310838340', '0310838342', '0310838698', '0311004329', '0311002421', '0310839157', '0311006011', '0310839189', '0310838864', '0311005312', '0310837960', '0311004313', '0310838902', '0311004571', '0310838967', '0310839549', '0311005485', '0310838914', '0311004327', '0311005275', '0311004927', '0311004570', '1110028747', '0311001859', '0311005696', '0311002062', '0311005927', '0311005134', '0311005442', '0311006234', '0311004780', '0311006037', '0311004252', '0311010658', '0311005488', '0311001615', '0311004362', '0311004131', '0311004132', '0311005616', '0311004337', '0311004339', '0311004618', '0311004626', '0311018298', '0311005336', '0311004535', '5611000374', '5611000373', '5611000372', '0311006039', '0311006106', '0311006746', '0311006347', '0311006527', '0311006591', '0311007217', '0311007633', '0311008159', '0311009988', '0311010402', '0311009735', '0311008157', '0311008585', '0311008561', '0311009354', '0311010273', '5611000700', '5611000702', '0311010861', '0311010790', '0311011837', '0311011594', '0311010857', '0311011367', '0311010834', '0311013560', '0311013659', '0311012292', '0311014723', '0311019450', '0311014196', '0311013896', '0311009007', '0311019364', '0311018834', '5611000902', '5611000903', '0311008621', '0311018794', '0311018591', '0311015783', '0311017843', '0311018482', '0311018315', '0311018316', '0311018297', '0311017841', '0311018582', '0311020068', '0311017886', '0311017936', '0311017937', '0311018595', '0311018594', '0311018588', '0811004117', '0811003880', '0311018973', '0311020319', '0311020049', '0311020048', '0311020050', '0311020051', '0311020008', '5611001401']
        generate_excel(fetch_data(split_list()))
        from item_fetch_conf import fetch_data, generate_excel, split_list
        generate_excel(fetch_data(split_list()))
        self.stdout.write(self.style.SUCCESS('Report Generated'))
